<app-navbar [shows_title]='true' [page]='"summary"'></app-navbar>
<div *ngIf="data">
  <div  style="height:250px; margin-bottom: -200px;" [ngClass]="{'red': cases['rolling_pop'] >= 10, 'orange': cases['rolling_pop'] >= 5 && cases['rolling_pop'] < 10,  'yellow': cases['rolling_pop'] >= 1 && cases['rolling_pop'] < 5, 'green': cases['rolling_pop'] < 1}">
    &nbsp;
  </div>
</div>
<div [ngClass]="{'content': is_full, 'content-mobile': !is_full}" style='background-color: white; margin-top: 50px;'>
  <div>
      <mat-progress-spinner mode="indeterminate" diameter="50" style="margin: 0 auto;" *ngIf="!dropdownList">
      </mat-progress-spinner>
  </div>
  <div *ngIf="data">
    <mat-card>
      <div *ngIf="dropdownList" style="padding-top: 5px; ">
          <form [formGroup]="dropdownList">
              <mat-form-field [style.width]="is_full ? '350px' : '100%'">
                  <mat-label>Select a Public Health Unit</mat-label>
                  <mat-select formControlName="phu" disableOptionCentering
                      (selectionChange)="routeonSelection(dropdownList.controls.phu.value)">
                      <ngx-mat-select-search formControlName="searchCtrl" [placeholderLabel]="'Search...'"
                          [noEntriesFoundLabel]="'Not found'" name="search"></ngx-mat-select-search>
                      <mat-option
                          *ngFor="let phu of phuArray |stringFilterBy:dropdownList.controls.searchCtrl.value:'phu'"
                          [value]="phu.value">
                          {{phu.phu}}
                      </mat-option>
                  </mat-select>
              </mat-form-field>
          </form>
      </div>
      <mat-card-header>
        <mat-card-title><h2>{{cases["phu"]}}</h2></mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div style="display:flex;align-items: flex-start;">
          <app-thermometer [color]=cases [text]=text> </app-thermometer>
          <div style="margin-left: 10px;">
            <p><span style="color:grey;font-size:0.8em">COVID Risk Level</span><br/>
            <span style="font-size:1.2em;font-weight:bold">{{cases['rolling_pop'] >= 10 ? 'Curving up Dangerously' : cases['rolling_pop'] >= 5 ? 'Curving Up Quickly' : cases['rolling_pop'] >= 1 ? 'Curving Up Somewhat' : 'Curving Down'}}</span></p>
            <p *ngIf="cases['rolling_pop'] >= 10">{{cases["phu"]}} is either actively experiencing an outbreak or is at extreme risk. COVID cases are exponentially growing and/or {{cases["phu"]}} COVID preparedness is significantly below international standards.</p>
            <p *ngIf="cases['rolling_pop'] >= 5 && cases['rolling_pop'] < 10"> {{cases["phu"]}} is at risk of an outbreak. COVID cases are either increasing at a rate likely to overwhelm hospitals and/or the state’s COVID preparedness is below international standards.</p>
            <p *ngIf="cases['rolling_pop'] >= 1 && cases['rolling_pop'] < 5">COVID in {{cases["phu"]}} is spreading in a slow and controlled fashion, and {{cases["phu"]}}’s COVID preparedness meets international standards.</p>
            <p *ngIf="cases['rolling_pop'] < 1"> {{cases["phu"]}} is on track to contain COVID. Cases are steadily decreasing and {{cases["phu"]}}’s COVID preparedness meets or exceeds international standards.</p>
            <p> </p>
          </div>
        </div>
        <div>
          <p style="font-size:1.2em;font-weight:bold">Recommended Action: </p>
          <ul>
            <li><strong>Social & Family Gatherings:</strong> {{cases['rolling_pop'] >= 10 ? 'No visitors' : cases['rolling_pop'] >= 5 ? 'No visitors' : cases['rolling_pop'] >= 1 ? 'Max 6 people from 1 other household' : 'Max 6 people from 3 other household'}}</li>
            <li><strong>Weddings:</strong> {{cases['rolling_pop'] >= 10 ? 'Max 6 people' : cases['rolling_pop'] >= 5 ? 'Max 6 people' : cases['rolling_pop'] >= 1 ? 'Max 25 people' : 'Max 50 people'}}</li>
            <li><strong>Indoor Events:</strong> {{cases['rolling_pop'] >= 10 ? 'No organised events' : cases['rolling_pop'] >= 5 ? 'No organised events' : cases['rolling_pop'] >= 1 ? 'No organised events' : '50 to 100 people depending on venue size'}}</li>
            <li><strong>Outdoor Events:</strong> {{cases['rolling_pop'] >= 10 ? 'No organised events' : cases['rolling_pop'] >= 5 ? 'Gathering of up to 15 people' : cases['rolling_pop'] >= 1 ? 'Gathering of up to 15 people' : '100 to 200 people depending on venue size'}}</li>
            <li><strong>Sports Training:</strong> {{cases['rolling_pop'] >= 10 ? 'Individual training only' : cases['rolling_pop'] >= 5 ? 'Indoor one individual only, outdoor pods of 15 (non contact)' : cases['rolling_pop'] >= 1 ? 'Indoor one individual only, outdoor pods of 15 (non contact)' : 'Indoor pods of 6, outdoor pods of 15 (non contact)'}}</li>
            <li><strong>Matches & Events:</strong> {{cases['rolling_pop'] >= 10 ? 'No events' : cases['rolling_pop'] >= 5 ? 'No events except specific exemptions' : cases['rolling_pop'] >= 1 ? 'No events except specific exemptions' : '50 people indoor, 100 outdoor, 200 stadia'}}</li>
            <li><strong>Gyms, Pools & Leisure Centres:</strong> {{cases['rolling_pop'] >= 10 ? 'Closed' : cases['rolling_pop'] >= 5 ? 'Closed' : cases['rolling_pop'] >= 1 ? 'Individual training only' : 'Open with protective measure'}}</li>
            <li><strong>Religious Services:</strong> {{cases['rolling_pop'] >= 10 ? 'Services move online. Funerals limited to 10 people.' : cases['rolling_pop'] >= 5 ? 'Services move online. Funerals limited to 25 people.' : cases['rolling_pop'] >= 1 ? 'Services move online. Funerals limited to 25 people.' : '50 people per service'}}</li>
            <li><strong>Bars serving food, Cafés & Restaurants:</strong> {{cases['rolling_pop'] >= 10 ? 'Takeaway/Delivery Only' : cases['rolling_pop'] >= 5 ? 'Outdoor only with a maximum of 15 people per table. Takeaway/Delivery.' : cases['rolling_pop'] >= 1 ? 'Range of restriction up to and including no indoor dining' : 'Groups of 6 from up to 3 households'}}</li>
            <li><strong>Wet Pubs:</strong> {{cases['rolling_pop'] >= 10 ? 'Takeaway/Delivery only' : cases['rolling_pop'] >= 5 ? 'Outdoor only with a maximum 15 people. Takeaway/Delivery' : cases['rolling_pop'] >= 1 ? 'Range of restrictions up to and including no indoor service' : 'Open Groups of 6 from up to 3 households'}}</li>
            <li><strong>Hotels, Guest Houses:</strong> {{cases['rolling_pop'] >= 10 ? 'Essential Purposes only' : cases['rolling_pop'] >= 5 ? 'Existing Guests & Essential Purposes only' : cases['rolling_pop'] >= 1 ? 'Services limited to Residents only' : 'Open with protective measures'}}</li>
            <li><strong>Retail & Services:</strong> {{cases['rolling_pop'] >= 10 ? 'Essential Retail only' : cases['rolling_pop'] >= 5 ? 'Primarily outdoor. Essential retail/services' : cases['rolling_pop'] >= 1 ? 'Open with protective measures' : 'Open with protective measures'}}</li>
            <li><strong>Indoor Cultural Venues:</strong> {{cases['rolling_pop'] >= 10 ? 'Venues closed Online services available' : cases['rolling_pop'] >= 5 ? 'Venues closed. Online services available' : cases['rolling_pop'] >= 1 ? 'Venues closed Libraries available for e-services/call & collect' : 'Open with protective measures'}}</li>
            <li><strong>Workplace:</strong> {{cases['rolling_pop'] >= 10 ? 'Essential workers only' : cases['rolling_pop'] >= 5 ? 'Essential & other designated workers only' : cases['rolling_pop'] >= 1 ? 'Attend only if absolutely necessary' : ' Essential Meetings, Induction & Training only'}}</li>
            <li><strong>Domestic Travel:</strong> {{cases['rolling_pop'] >= 10 ? 'Discouraged' : cases['rolling_pop'] >= 5 ? 'Domestic only. Except for essential work, education & essential purposes' : cases['rolling_pop'] >= 1 ? 'Domestic only. Except for essential work, education & essential purposes' : 'No restrictions'}}</li>
            <li><strong>Schools & Childcare:</strong> {{cases['rolling_pop'] >= 10 ? 'Recommendations based on situation and evidence at time' : cases['rolling_pop'] >= 5 ? 'Open with protective measures' : cases['rolling_pop'] >= 1 ? 'Open with protective measures' : 'Open with protective measures'}}</li>
            <li><strong>Adult & Higher Education:</strong> {{cases['rolling_pop'] >= 10 ? 'Recommendations based on situation and evidence at time' : cases['rolling_pop'] >= 5 ? 'Move online On-site attendance only when essential' : cases['rolling_pop'] >= 1 ? 'Open. Escalate all appropriate protective measures limit congregation' : 'Open with protective measures'}}</li>
            <li><strong>Care Homes:</strong> Visiting suspended, aside from critical and compassionate circumstances</li>
            <li><strong>Over 70s & Medically Vulnerable:</strong> Exercise judgement regarding engaging with others and in activities outside home.</li>
          </ul>
        </div>
      </mat-card-content>

    </mat-card>
    <app-map-fsa> </app-map-fsa>
    <div *ngIf='cases'>
      <h2>Scorecard</h2>
    </div>
    <div *ngIf='cases'>
      <h4 style="margin-bottom:0px">Daily new cases per 100k population</h4>
      <p style="margin-top:0px;"><span style="color:grey;font-size:0.8em">{{cases["phu"]}}<br/>Last Data on {{cases["date"] | date}}</span></p>
      Over the last week, {{cases["phu"]}} has averaged {{cases["rolling"] | number : '1.2-2' }} cases per day ({{cases["rolling_pop"] | number : '1.2-2'}} for every 100,000 residents).
      <div style="max-width: 100%;"><app-graph [graph_data]='data' variable="rolling_pop"></app-graph></div>
    </div>
    <div *ngIf='rt'>
      <h4 style="margin-bottom:0px">Infection Rate (Rt)</h4>
      <p style="margin-top:0px;"><span style="color:grey;font-size:0.8em;">{{cases["phu"]}}<br/>Last Data on {{rt["date"] | date}}</span></p>
      On average, each person in {{rt["phu"]}} with COVID is infecting {{rt["rt_ml"] | number : '1.2-2'}} other people.
      <app-graph [graph_data]='data' variable="rt_ml"></app-graph>
    </div>
    <div *ngIf='testing'>
      <h4 style="margin-bottom:0px">Testing Capacity</h4>
      <p style="margin-top:0px;"><span style="color:grey;font-size:0.8em">{{cases["phu"]}}<br/>Last Data on {{testing["date"] | date}}</span></p>
      In the last 7 days, on average {{testing["rolling_test_twenty_four"] | percent : '1.2-2'}} of tests have been returned within 24 hours.
      <app-graph [graph_data]='data' variable="rolling_test_twenty_four"></app-graph>
    </div>
    <div *ngIf='icu'>
      <h4 style="margin-bottom:0px">ICU Bed Capacity</h4>
      <p style="margin-top:0px;"><span style="color:grey;font-size:0.8em">{{cases["phu"]}}<br/>Last Data on {{icu["date"] | date}}</span></p>
      {{icu["critical_care_pct"] | percent  : '1.2-2'}} of ICU beds in {{cases["phu"]}} are currently occupied. There are currently {{icu["confirmed_positive"]}} COVID patients in the ICU.
      <app-graph [graph_data]='data' variable="critical_care_pct"></app-graph>
    </div>
  </div>
  <!-- <div *ngIf="displayFooter">
    <div *ngIf="epi">
      <h2>Epidemiologic summary</h2>
      <mat-card class="highlights">
        <mat-card-header>
          <img mat-card-avatar src="https://www.flaticon.com/svg/static/icons/svg/1037/1037334.svg" alt="Summary" style="max-height: 50px;">
          <mat-card-title>Data Highlights</mat-card-title>
          <mat-card-subtitle>(as of {{epi["outcome"]["Date"]}})</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <ul>
            <li>To date, {{epi["outcome"]["Total"]}} confirmed cases of COVID-19 have been reported in {{cases["phu"]}}</li>
            <li>The median age of confirmed cases is AGE years (range: X to Y years) with the highest cases counts among the X and Y age groups</li>
            <li>There have {{epi["outcome"]["Fatal"]}} reported deaths among confirmed cases</li>
          </ul>
        </mat-card-content>
      </mat-card>
      <div *ngIf="epi['outcome']">
        <p><b>Table 1.</b> COVID-19 cases and outbreaks in {{cases["phu"]}} by outcome status</p>
        <table class="mat-elevation-z8">
          <tr>
            <th  >Measure</th>
            <th >Number Todate</th>
            <th  >Last Two Weeks</th>
          </tr>
          <tr>
            <td>Fatal</td>
            <td>{{epi["outcome"]["Fatal"]?epi["outcome"]["Fatal"] + ' cases ('+ (epi["outcome_pct"]["Fatal"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["outcome"]["Fatal"]?epi_recent["outcome"]["Fatal"] + ' cases ('+ (epi_recent["outcome_pct"]["Fatal"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >Not Resolved</td>
            <td>{{epi["outcome"]["Not Resolved"]?epi["outcome"]["Not Resolved"] + ' cases ('+ (epi["outcome_pct"]["Not Resolved"]| percent) +')':'0 cases'}}</td>
            <td>{{epi_recent["outcome"]["Not Resolved"]?epi_recent["outcome"]["Not Resolved"] + ' cases ('+ (epi_recent["outcome_pct"]["Not Resolved"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >Resolved</td>
            <td >{{epi["outcome"]["Resolved"]?epi["outcome"]["Resolved"] + ' cases ('+ (epi["outcome_pct"]["Resolved"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["outcome"]["Resolved"]?epi_recent["outcome"]["Resolved"] + ' cases ('+ (epi_recent["outcome_pct"]["Resolved"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >Total</td>
            <td >{{epi["outcome"]["Total"]?epi["outcome"]["Total"] + ' cases ('+ (epi["outcome_pct"]["Total"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["outcome"]["Total"]?epi_recent["outcome"]["Total"] + ' cases ('+ (epi_recent["outcome_pct"]["Total"]| percent) +')':'0 cases'}}</td>
          </tr>
        </table>
      </div>
      <div *ngIf="epi['age_group']">
        <p><b>Table 2.</b> Summary of confirmed COVID-19 cases in {{cases["phu"]}} by age group (n={{epi["outcome"]["Total"]}}): January 31, 2020 to {{epi["outcome"]["Date"]}}</p>
        <table  class="mat-elevation-z8">
          <tr>
            <th >Age Group</th>
            <th >Number Todate</th>
            <th >Last Two Weeks</th>
          </tr>
          <tr>
            <td >&lt;20</td>
            <td >{{epi["age_group"]["<20"]?epi["age_group"]["<20"] + ' cases ('+ (epi["age_group_pct"]["<20"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["<20"]?epi_recent["age_group"]["<20"] + ' cases ('+ (epi_recent["age_group_pct"]["<20"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >20s</td>
            <td >{{epi["age_group"]["20s"]?epi["age_group"]["20s"] + ' cases ('+ (epi["age_group_pct"]["20s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["20s"]?epi_recent["age_group"]["20s"] + ' cases ('+ (epi_recent["age_group_pct"]["20s"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >30s</td>
            <td >{{epi["age_group"]["30s"]?epi["age_group"]["30s"] + ' cases ('+ (epi["age_group_pct"]["30s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["30s"]?epi_recent["age_group"]["30s"] + ' cases ('+ (epi_recent["age_group_pct"]["30s"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >40s</td>
            <td >{{epi["age_group"]["40s"]?epi["age_group"]["40s"] + ' cases ('+ (epi["age_group_pct"]["40s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["40s"]?epi_recent["age_group"]["40s"] + ' cases ('+ (epi_recent["age_group_pct"]["40s"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >50s</td>
            <td >{{epi["age_group"]["50s"]?epi["age_group"]["50s"] + ' cases ('+ (epi["age_group_pct"]["50s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["50s"]?epi_recent["age_group"]["50s"] + ' cases ('+ (epi_recent["age_group_pct"]["50s"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >60s</td>
            <td >{{epi["age_group"]["60s"]?epi["age_group"]["60s"] + ' cases ('+ (epi["age_group_pct"]["60s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["60s"]?epi_recent["age_group"]["60s"] + ' cases ('+ (epi_recent["age_group_pct"]["60s"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >70s</td>
            <td >{{epi["age_group"]["70s"]?epi["age_group"]["70s"] + ' cases ('+ (epi["age_group_pct"]["70s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["70s"]?epi_recent["age_group"]["70s"] + ' cases ('+ (epi_recent["age_group_pct"]["70s"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >80s</td>
            <td >{{epi["age_group"]["80s"]?epi["age_group"]["80s"] + ' cases ('+ (epi["age_group_pct"]["80s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["80s"]?epi_recent["age_group"]["80s"] + ' cases ('+ (epi_recent["age_group_pct"]["80s"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >90s</td>
            <td >{{epi["age_group"]["90s"]?epi["age_group"]["90s"] + ' cases ('+ (epi["age_group_pct"]["90s"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["age_group"]["90s"]?epi_recent["age_group"]["90s"] + ' cases ('+ (epi_recent["age_group_pct"]["90s"]| percent) +')':'0 cases'}}</td>
          </tr>
        </table>
      </div>
      <div *ngIf="epi['case_acquisition']">
        <p><b>Table 3.</b> Most likely exposure setting for confirmed COVID-19 cases in {{cases["phu"]}} (n={{epi["outcome"]["Total"]}}): January 31, 2020 to {{epi["outcome"]["Date"]}}</p>
        <table  class="mat-elevation-z8">
          <tr>
            <th >Exposure Setting</th>
            <th >Number Todate</th>
            <th >Last Two Weeks</th>
          </tr>
          <tr>
            <td >Outbreak</td>
            <td >{{epi["case_acquisition"]["OB"]?epi["case_acquisition"]["OB"] + ' cases ('+ (epi["case_acquisition_pct"]["OB"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["case_acquisition"]["OB"]?epi_recent["case_acquisition"]["OB"] + ' cases ('+ (epi_recent["case_acquisition_pct"]["OB"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >Close Contact</td>
            <td >{{epi["case_acquisition"]["CC"]?epi["case_acquisition"]["CC"] + ' cases ('+ (epi["case_acquisition_pct"]["CC"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["case_acquisition"]["CC"]?epi_recent["case_acquisition"]["CC"] + ' cases ('+ (epi_recent["case_acquisition_pct"]["CC"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >Community Spread</td>
            <td >{{epi["case_acquisition"]["No Epi-link"]?epi["case_acquisition"]["No Epi-link"] + ' cases ('+ (epi["case_acquisition_pct"]["No Epi-link"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["case_acquisition"]["No Epi-link"]?epi_recent["case_acquisition"]["No Epi-link"] + ' cases ('+ (epi_recent["case_acquisition_pct"]["No Epi-link"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >Travel</td>
            <td >{{epi["case_acquisition"]["Travel"]?epi["case_acquisition"]["Travel"] + ' cases ('+ (epi["case_acquisition_pct"]["Travel"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["case_acquisition"]["Travel"]?epi_recent["case_acquisition"]["Travel"] + ' cases ('+ (epi_recent["case_acquisition_pct"]["Travel"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >No Info-Missing</td>
            <td >{{epi["case_acquisition"]["No Info-Missing"]?epi["case_acquisition"]["No Info-Missing"] + ' cases ('+ (epi["case_acquisition_pct"]["No Info-Missing"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["case_acquisition"]["No Info-Missing"]?epi_recent["case_acquisition"]["No Info-Missing"] + ' cases ('+ (epi_recent["case_acquisition_pct"]["No Info-Missing"]| percent) +')':'0 cases'}}</td>
          </tr>
          <tr>
            <td >No Info-Unknown</td>
            <td >{{epi["case_acquisition"]["No Info-Unk"]?epi["case_acquisition"]["No Info-Unk"] + ' cases ('+ (epi["case_acquisition_pct"]["No Info-Unk"]| percent) +')':'0 cases'}}</td>
            <td >{{epi_recent["case_acquisition"]["No Info-Unk"]?epi_recent["case_acquisition"]["No Info-Unk"] + ' cases ('+ (epi_recent["case_acquisition_pct"]["No Info-Unk"]| percent) +')':'0 cases'}}</td>
          </tr>
        </table>
      </div>
      <h4>''</h4>
    </div>
  </div> -->
</div>
<app-footer *ngIf="displayFooter"></app-footer>
